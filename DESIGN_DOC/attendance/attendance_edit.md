# 出欠編集 (Attendance Edit)

## 目的
- 締切前はメンバーが自己都合で回答を更新できるようにし、最新の参加状況を維持する。
- 締切後は運営のみが編集し、調整結果を反映できるようにする。

## 編集制御
- `attendance` テーブルに `locked_at` を持たせ、締切到達時に Edge Function が値をセット。
- `locked_at` が NULL かつ `member_id == session.user.id` の場合に限り更新許可。
- `manager` 権限は常に更新可能だが、変更理由をコメントに残すよう UI で促す。

## UI / UX
- 登録モーダルと同じフォームを使用し、既存値を初期設定。
- 締切後にメンバーが開くと「締切を過ぎています。変更は運営に連絡してください。」のトーストを表示し、フォームを disable。

## 技術ポイント
- RLS ポリシー: `WITH CHECK (member_id = auth.uid() AND locked_at IS NULL)` を設定。
- 更新後に `attendance_change_logs` へ差分を Insert し、運営が変更履歴を確認できるようにする。

## 決定理由
- 締切後に回答を固定することで、当日の参加計画が崩れるリスクを低減。
- 差分ログにより、「誰がいつ変更したか」を明確にし、チーム内の透明性を確保。
