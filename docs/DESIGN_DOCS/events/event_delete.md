# イベント削除 (Event Delete)

## 目的
- 誤登録や中止が発生した際に、参加者へ混乱を招かず安全に削除できる運用を整える。
- 過去の統計と監査目的で履歴を保持する。

## 削除ポリシー
- `events` テーブルには `status` 列（`scheduled/cancelled/deleted`）を持たせ、論理削除を採用。
- 出欠やコメントを保持するため、削除時は関連テーブルを消さない。
- RLS で `manager` 権限のみ `status` を `deleted` に更新可能。

## フロー
1. 詳細画面の「削除」ボタン押下で確認モーダル表示。
2. Supabase RPC `events_cancel` を呼び、`status=deleted` と `deleted_at` を更新。
3. Edge Function 経由で OneSignal 通知を送信し、メンバーへ中止連絡。
4. 一覧表示では `status=deleted` を除外し、詳細画面にアクセスした場合はキャンセル表示のみ行う。

## 決定理由
- 論理削除により、将来のレポートや監査ログにイベント履歴を残す運営ニーズを満たす。
- RPC で状態遷移を一本化することで、削除時に追加通知やストレージ掃除等の副作用を付け足しやすい。
